Circsim=SC.Application.create({NAMESPACE:"Circsim",VERSION:"0.1.0",ERRORCOLOR:"#FFD6D6",CORRECTCOLOR:"#E8FFCA",NORMALCOLOR:"#FBFBFB",pvViewDisplay:""});Circsim.cellController=SC.ObjectController.create({});Circsim.cellsController=SC.ArrayController.create({colsBinding:"Circsim.procedureController.columns",allCells:function(){var b=this.get("cols"),a=[];b.forEach(function(d){var c=d.get("cells");c.forEach(function(e){a.pushObject(e)})});return a}.property("cols").cacheable()});Circsim.columnController=SC.Object.create({content:"",current:0});Circsim.columnsController=SC.ArrayController.create({contentBinding:"Circsim.procedureController.columns"});Circsim.contentController=SC.Object.create({contentDisplay:""});Circsim.instructionsController=SC.Object.create({content:""});Circsim.messageController=SC.Object.create({content:"",title:"",titleColor:"#FBFBFB",color:"#FBFBFB"});Circsim.messagesController=SC.ArrayController.create({});Circsim.drController=SC.ObjectController.create({content:function(){return Circsim.columnsController.objectAt(0)}.property()});Circsim.rrController=SC.ObjectController.create({content:function(){return Circsim.columnsController.objectAt(1)}.property()});Circsim.ssController=SC.ObjectController.create({content:function(){return Circsim.columnsController.objectAt(2)}.property()});Circsim.procedureController=SC.ObjectController.create({contentBinding:SC.Binding.single("Circsim.proceduresController.selection"),currentPV:function(){var b=this.get("content").get("rows");var a=this.get("content").get("initialVariable");return b[a]}.property("content")});Circsim.proceduresController=SC.ArrayController.create({});Circsim.pvSelectionController=SC.Object.create({content:""});Circsim.relationshipEvaluationsController=SC.Object.create({content:[],current:0});Circsim.toolbarDisplayController=SC.Object.create({helpDisplay:""});SC.GridView.prototype.mixin({contentIndexesInRect:function(i){var b=this.get("rowHeight")||48,f=this.get("content"),e=(f)?f.get("length"):0,j=this.get("clippingFrame").width,g=this.get("itemsPerRow"),m=Math.ceil(e/g),c=Math.floor(j/g);if(this.get("insertionOrientation")===SC.HORIZONTAL_ORIENTATION){var d=Math.floor(SC.minY(i)/b)*g,h=Math.ceil(SC.maxY(i)/b)*g;return SC.IndexSet.create(d,h-d)}else{var h=0,d=e;for(var l=0;l<g;++l){var a=l*c,k=a+c;if(k>SC.minX(i)||a<SC.maxX(i)){d=Math.min(d,Math.floor(SC.minY(i)/b)+(l*m));h=Math.max(h,Math.min(Math.ceil(SC.maxY(i)/b)+(l*m),(l*m)+m))}}return SC.IndexSet.create(d,h-d)}},layoutForContentIndex:function(d){var a=this.get("rowHeight")||48,f=this.get("content"),e=(f)?f.get("length"):0,h=this.get("clippingFrame").width,g=this.get("itemsPerRow"),k=Math.ceil(e/g),b=Math.floor(h/g),i=this.get("insertionOrientation")===SC.HORIZONTAL_ORIENTATION,j=i?Math.floor(d/g):d%k,c=i?d-(g*j):Math.floor(d/k);return{left:c*b,top:j*a,height:a,width:b}}});SC.TargetAction={action:null,target:null,actOnMouseDown:NO,triggerAction:function(a){if(!this.get("isEnabled")){return false}this.set("isActive",YES);this.performAction(a);this.didTriggerAction();this.invokeLater("set",200,"isActive",NO);return true},performAction:function(a){var b=this.get("action");var c=this.get("target")||null;if(b){this.getPath("pane.rootResponder").sendAction(b,c,this,this.get("pane"))}},didTriggerAction:function(){},mouseDown:function(a){if(!this.get("isEnabled")){return YES}this._actsOnMouseDown=!!this.get("actOnMouseDown");if(this._actsOnMouseDown){this.performAction(a)}else{this.set("isActive",YES);this._isMouseDown=YES}return YES},mouseExited:function(a){if(this._actsOnMouseDown){return YES}if(this._isMouseDown){this.set("isActive",NO)}return YES},mouseEntered:function(a){if(this._actsOnMouseDown){return YES}this.set("isActive",this._isMouseDown);return YES},mouseUp:function(b){if(this._actsOnMouseDown){return YES}if(this._isMouseDown){this.set("isActive",NO)}this._isMouseDown=false;var a=this.$().within(b.target);if(a&&this.get("isEnabled")){this.performAction(b)}return true}};SC.TEMPLATES.circsim_intro=SC.Handlebars.compile("<p>CIRCSIM is a computer model with a heart in a chest, systemic arteries and arterioles, a capillary bed, and veins returning blood to the heart.  CIRCSIM is thus a complete circulatory system, and it functions like one. </p>\n\n<p>CIRCSIM can simulate normal physiology.  The simulation includes baroreceptors similar in operation to those which are situated at the bifurcation of the common carotid artery and at the aortic arch.  These act to stabilize blood pressure.</p>\n\n<p>However, the model has been simplified, and the heart is treated as a single chamber filling from the right atrium and pumping blood into the aorta.  The pulmonary circulation is not (as in life) in series with the systemic circulation.</p>\n\n<h4>Select a procedure from the left to begin.</h4>");SC.TEMPLATES.footer=SC.Handlebars.compile('<div id="footer">\n  <div id="copyright">\n    © 1985  Rush University, Chicago, Illinois\n  </div>\n</div>');SC.TEMPLATES.procedure=SC.Handlebars.compile('<body>\n\n  <div id="procedure">\n    <h1 id="procedure-title">{{title}}</h1>\n    <div id="procedure-instructions">\n      {{instructions}}\n    </div>\n    <div id="procedure-interaction">\n      <div id="grid">\n        <div class="column">\n          {{#view Circsim.contentViews.drView tagName="div" class="header"}}\n            {{content.header}}            \n          {{/view}}          \n          {{collection Circsim.contentViews.drCellsView tagName="div" class="cell-group" itemClass="cell"}}\n        </div>\n        <div class="column">\n          {{#view Circsim.contentViews.rrView tagName="div" class="header"}}\n            {{content.header}}            \n          {{/view}}          \n          {{collection Circsim.contentViews.rrCellsView tagName="div" class="cell-group" itemClass="cell"}}\n        </div>\n        <div class="column">\n          {{#view Circsim.contentViews.ssView tagName="div" class="header"}}\n            {{content.header}}            \n          {{/view}}          \n          {{collection Circsim.contentViews.ssCellsView tagName="div" class="cell-group" itemClass="cell"}}\n        </div>\n\n      </div>\n      <div id="procedure-messages">\n        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam ultricies molestie bibendum. Ut tincidunt scelerisque ligula vel faucibus. Pellentesque vitae felis ac elit dictum rhoncus. Praesent lacus mauris, laoreet non interdum quis, vestibulum ac tellus. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Curabitur ac ipsum enim, sed placerat metus. In eu sapien elit, ac imperdiet dui. Proin tempus dui et massa molestie venenatis luctus quam blandit. In urna nunc, consectetur blandit venenatis sit amet, dignissim varius turpis. Quisque ligula justo, dictum quis convallis ac, interdum eget lectus</p>\n        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam ultricies molestie bibendum. Ut tincidunt scelerisque ligula vel faucibus. Pellentesque vitae felis ac elit dictum rhoncus. Praesent lacus mauris, laoreet non interdum quis, vestibulum ac tellus. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Curabitur ac ipsum enim, sed placerat metus. In eu sapien elit, ac imperdiet dui. Proin tempus dui et massa molestie venenatis luctus quam blandit. In urna nunc, consectetur blandit venenatis sit amet, dignissim varius turpis. Quisque ligula justo, dictum quis convallis ac, interdum eget lectus</p>        \n      </div>\n    </div>\n  </div>\n</body>');SC.TEMPLATES.title=SC.Handlebars.compile("<h1>Circsim</h1>\n<h2>A SIMULATION OF THE HEART AND PERIPHERAL CIRCULATION</h2>\n\n      <p>© 1985  Rush University, Chicago, Illinois</p>\n           <p>All Rights Reserved (Model Excluded)</p>\n\n<p>Instruction: Dr. A. A. Rovick, Dept. of Physiology</p>\n<p>Additional instruction: Drs. L. Brenner (Office of Computer-Based Education) and J. A. Michael (Dept. of Physiology), Rush Univ.</p>\n\n<p>Model by: Dr. C. J. Dickinson, University Hospital Medical School, England and Drs. K. Ahmed, C. H. Goldsmith, and D. L. Sackett, McMaster University Medical School, Canada</p>\n\n<p>IBM PC Program by: Dr. Joel Michael</p>\n<p>2011 Update: Ryan Golden</p>\n");Circsim.statechart=SC.Statechart.create({initialState:"Title",Title:SC.State.design({enterState:function(){Circsim.contentController.set("contentDisplay","Circsim.contentViews.titleView");Circsim.set("sidebarView","Circsim.sidebarViews.titleView");Circsim.toolbarDisplayController.set("helpDisplay","display:none;")},startCircsim:function(){this.gotoState("Running")}}),Running:SC.State.design({enterState:function(){Circsim.set("sidebarView","Circsim.sidebarViews.runningView");Circsim.toolbarDisplayController.set("helpDisplay","")},initialSubstate:"Introduction",Introduction:SC.State.design({enterState:function(){Circsim.contentController.set("contentDisplay","Circsim.contentViews.introView")}}),Procedure:SC.State.design({enterState:function(){var a=Circsim.procedureController;if(a.get("title")){Circsim.cellsController.get("allCells").forEach(function(b){b.set("value",null)});Circsim.cellsController.get("allCells").forEach(function(b){b.set("correctAnswer",null)});Circsim.columnController.set("current",0);Circsim.columnController.set("content","");Circsim.relationshipEvaluationsController.set("current",0);CoreCircsim.createGrid(a)}else{console.log("No procedure selected. Catching this bug.");this.gotoState("Running")}},initialSubstate:"ProcedureIntro",ProcedureIntro:SC.State.design({enterState:function(){Circsim.contentController.set("contentDisplay","Circsim.contentViews.procedureIntroView")},beginProcedure:function(){this.gotoState("InitialVariableEvaluation")}}),InitialVariableEvaluation:SC.State.design({initialSubstate:"IVStudentPrompt",IVStudentPrompt:SC.State.design({enterState:function(){Circsim.contentController.set("contentDisplay","Circsim.contentViews.procedureView");Circsim.messageController.set("title","Primary Variable");Circsim.messageController.set("content","Please use the menu to the left to select the primary variable that is changed in this procedure. When you have made your decision, click the Next button above.");Circsim.set("pvViewDisplay","Circsim.PVView")},next:function(){this.selectedPV()},selectedPV:function(){var d=Circsim.procedureController.get("content");var e=d.get("rows");var c=Circsim.pvSelectionController.get("content");var b=e.indexOf(c);var a=CoreCircsim.evaluateInitialVariableSelection(d,b);if(a){this.clickCorrectIVa()}else{this.clickIncorrectIVa()}},clickCorrectIVa:function(){this.gotoState("IVSelectDirection")},clickIncorrectIVa:function(){this.gotoState("IVSecondChance")}}),IVSecondChance:SC.State.design({enterState:function(){Circsim.messageController.set("content","Sorry, that is not the primary variable that is changed. Please try again.");Circsim.messageController.set("color",Circsim.ERRORCOLOR)},exitState:function(){Circsim.messageController.set("content","");Circsim.messageController.set("color",Circsim.NORMALCOLOR)},next:function(){this.selectedPV()},selectedPV:function(){var d=Circsim.procedureController.get("content");var e=d.get("rows");var c=Circsim.pvSelectionController.get("content");var b=e.indexOf(c);var a=CoreCircsim.evaluateInitialVariableSelection(d,b);if(a){this.clickCorrectIVb()}else{this.clickIncorrectIVb()}},clickCorrectIVb:function(){this.gotoState("IVSelectDirection")},clickIncorrectIVb:function(){this.gotoState("IVIncorrectSummary")}}),IVSelectDirection:SC.State.design({enterState:function(){Circsim.messageController.set("content","Great! Now, click on the cell in the table to select the direction that this variable changes.");var b=Circsim.procedureController.get("initialVariable");var a=Circsim.cellsController.get("allCells").objectAt(b);a.set("isEnabled",YES);Circsim.set("pvViewDisplay","Circsim.PVSummaryView")},clickedOnCell:function(b){var a=b.selection.firstObject();CoreCircsim.updateCell(a)},next:function(){var d=Circsim.procedureController.get("content");var c=d.get("initialVariable");var b=d.get("columns").firstObject().get("cells").objectAt(c);var e=b.get("value");var a=CoreCircsim.evaluateInitialVariableDirection(d,e);if(a){this.directionCorrect()}else{this.directionIncorrect()}},directionCorrect:function(){this.gotoState("IVCorrectSummary")},directionIncorrect:function(){this.gotoState("IVDirectionSecondChance")}}),IVDirectionSecondChance:SC.State.design({enterState:function(){Circsim.messageController.set("content","Sorry, that's the wrong direction. Please try again. When you have made your selection, click the 'Next' button above");Circsim.messageController.set("color",Circsim.ERRORCOLOR);Circsim.set("pvViewDisplay","Circsim.PVSummaryView")},exitState:function(){Circsim.messageController.set("content","");Circsim.messageController.set("color",Circsim.NORMALCOLOR)},clickedOnCell:function(b){var a=b.selection.firstObject();CoreCircsim.updateCell(a)},next:function(){var d=Circsim.procedureController.get("content");var c=d.get("initialVariable");var b=d.get("columns").firstObject().get("cells").objectAt(c);var e=b.get("value");var a=CoreCircsim.evaluateInitialVariableDirection(d,e);if(a){this.directionCorrect()}else{this.directionIncorrect()}},directionCorrect:function(){this.gotoState("IVCorrectSummary")},directionIncorrect:function(){this.gotoState("IVIncorrectSummary")}}),IVCorrectSummary:SC.State.design({enterState:function(){Circsim.messageController.set("content","Great!  You have identified the primary variable and the direction that it changes.  Please click Next to go on.");Circsim.messageController.set("color",Circsim.CORRECTCOLOR);Circsim.set("pvViewDisplay","Circsim.PVSummaryView");var b=Circsim.procedureController.get("content");var a=Circsim.cellsController.get("allCells");CoreCircsim.setPVToCorrect(b,a)},exitState:function(){Circsim.messageController.set("content","");Circsim.messageController.set("color",Circsim.NORMALCOLOR)},next:function(){this.completeRestOfColumn()},completeRestOfColumn:function(){this.gotoState("ColumnInput")}}),IVIncorrectSummary:SC.State.design({enterState:function(){Circsim.messageController.set("content","Sorry, that is incorrect.  The correct answer is now displayed to the left.  Please click Next to move on.");Circsim.messageController.set("color",Circsim.ERRORCOLOR);Circsim.set("pvViewDisplay","Circsim.PVSummaryView");var b=Circsim.procedureController.get("content");var a=Circsim.cellsController.get("allCells");CoreCircsim.setPVToCorrect(b,a)},exitState:function(){Circsim.messageController.set("content","");Circsim.messageController.set("color",Circsim.NORMALCOLOR)},next:function(){this.completeRestOfColumn()},completeRestOfColumn:function(){this.gotoState("ColumnInput")}})}),ColumnInput:SC.State.design({enterState:function(){this.setCurrentColumn();var b=Circsim.columnController.get("content").get("header");Circsim.messageController.set("title","");Circsim.messageController.set("content","At this time, please fill out the "+b+" column.");var a=Circsim.columnController.get("content").get("cells");Circsim.cellsController.get("allCells").forEach(function(d){if(a.contains(d)){d.set("isEnabled",true)}else{d.set("isEnabled",false)}})},exitState:function(){Circsim.cellsController.get("allCells").forEach(function(a){a.set("isEnabled",false)});Circsim.messageController.set("content","")},setCurrentColumn:function(){var a=Circsim.columnController.get("current");Circsim.columnController.set("content",Circsim.columnsController.objectAt(a))},clickedOnCell:function(b){var a=b.selection.firstObject();CoreCircsim.updateCell(a)},next:function(){var a=Circsim.columnController.get("content").get("cells");var b=[];a.forEach(function(d){b.push(d.get("value"))});if(b.contains(null)||b.length>7){b=b.slice(0,7);if(b.contains(null)){Circsim.messageController.set("content","You haven't filled in a value for all the cells yet.  Please do that before continuing.")}else{this.beginEvaluations()}}else{this.beginEvaluations()}},beginEvaluations:function(){this.gotoState("ColumnEvaluation")}}),ColumnEvaluation:SC.State.design({initialSubstate:"RelationshipEvaluation",RelationshipEvaluation:SC.State.design({initialSubstate:"REIntroduction",enterState:function(){var a=Circsim.procedureController.get("content").get("relationshipEvaluations");Circsim.relationshipEvaluationsController.set("content",a);Circsim.relationshipEvaluationsController.set("current",0);Circsim.messageController.set("title","Relationship Evaluations")},exitState:function(){Circsim.messageController.set("title","")},REIntroduction:SC.State.design({enterState:function(){var a=Circsim.relationshipEvaluationsController.get("current"),b=Circsim.relationshipEvaluationsController.get("content").objectAt(a);Circsim.messageController.set("content",b.intro);Circsim.messageController.set("color",Circsim.NORMALCOLOR)},next:function(){this.evaluateRE()},evaluateRE:function(){var f=Circsim.columnController.get("content"),c=f.get("cells"),d=[],e=Circsim.relationshipEvaluationsController.get("content");if(e){var a=Circsim.relationshipEvaluationsController.get("current");e=e.objectAt(a);c.forEach(function(g){d.push(g.get("value"))});var b=CoreCircsim.evaluateRelationships(e,d);if(b){Circsim.messageController.set("content",b);this.gotoState("REErrorCorrection")}else{this.gotoState("RECorrectSummary")}}else{this.gotoState("ProcedureSpecificEvaluation")}}}),REErrorCorrection:SC.State.design({enterState:function(){var b=Circsim.relationshipEvaluationsController.get("current");var c=Circsim.relationshipEvaluationsController.get("content").objectAt(b);Circsim.messageController.set("content",c.errorMessage);Circsim.messageController.set("color",Circsim.ERRORCOLOR);var a=c.equation;Circsim.columnController.get("content").get("cells").forEach(function(d){d.set("isEnabled",false)});a.forEach(function(e){var d=Circsim.columnController.get("content").get("cells").objectAt(e);d.set("isEnabled",true)})},exitState:function(){Circsim.messageController.set("content","");Circsim.messageController.set("color",Circsim.NORMALCOLOR);Circsim.cellsController.get("allCells").forEach(function(a){a.set("isEnabled",false)})},clickedOnCell:function(b){var a=b.selection.firstObject();CoreCircsim.updateCell(a)},next:function(){this.submitRECorrections()},submitRECorrections:function(){var f=Circsim.columnController.get("content"),c=f.get("cells"),d=[],a=Circsim.relationshipEvaluationsController.get("current"),e=Circsim.relationshipEvaluationsController.get("content").objectAt(a);c.forEach(function(g){d.push(g.get("value"))});var b=CoreCircsim.evaluateRelationships(e,d);if(b){this.gotoState("REIncorrectSummary")}else{this.gotoState("RECorrectSummary")}}}),RECorrectSummary:SC.State.design({enterState:function(){var a=Circsim.relationshipEvaluationsController.get("current"),b=Circsim.relationshipEvaluationsController.get("content").objectAt(a);Circsim.messageController.set("content",b.summaryCorrectMessage);Circsim.messageController.set("color",Circsim.CORRECTCOLOR)},exitState:function(){Circsim.messageController.set("content","");Circsim.messageController.set("color",Circsim.NORMALCOLOR)},next:function(){var a=Circsim.relationshipEvaluationsController.get("current"),b=Circsim.relationshipEvaluationsController.get("content").length;if(a+1==b){this.gotoState("ProcedureSpecificEvaluation")}else{Circsim.relationshipEvaluationsController.set("current",a+1);this.gotoState("REIntroduction")}}}),REIncorrectSummary:SC.State.design({enterState:function(){var a=Circsim.relationshipEvaluationsController.get("current"),b=Circsim.relationshipEvaluationsController.get("content").objectAt(a);Circsim.messageController.set("content",b.summaryIncorrectMessage);Circsim.messageController.set("color",Circsim.ERRORCOLOR)},exitState:function(){Circsim.messageController.set("content","");Circsim.messageController.set("color",Circsim.NORMALCOLOR)},next:function(){var a=Circsim.relationshipEvaluationsController.get("current"),b=Circsim.relationshipEvaluationsController.get("content").length;if(a+1==b){this.gotoState("ProcedureSpecificEvaluation")}else{Circsim.relationshipEvaluationsController.set("current",a+1);this.gotoState("REIntroduction")}}})}),ProcedureSpecificEvaluation:SC.State.design({initialSubstate:"ProcedureSpecificIntro",ProcedureSpecificIntro:SC.State.design({enterState:function(){Circsim.messageController.set("title","Procedure Specific Evaluations");Circsim.messageController.set("content","Your predictions will now be evaluated for procedure specific errors.")},next:function(){this.gotoState("PerformProcedureSpecificEvaluations")}}),PerformProcedureSpecificEvaluations:SC.State.design({enterState:function(){var e=Circsim.columnController.get("content"),i=e.get("cells"),b=[],a=Circsim.procedureController.get("content"),k=Circsim.columnController.get("current");i.forEach(function(l){b.push(l.get("value"))});var g=CoreCircsim.evaluateProcedureSpecificErrors(a,k,b);if(g.length===0){Circsim.messageController.set("content","Your answers don't match any of the answer keys.  This is probably an error.  Please notify Dr. Michael or Dr. Shannon and record the answers you submitted so we can fix this bug.");this.gotoState("DisplayProcedureSpecificComment")}else{Circsim.messageController.set("content","The evaluation is complete.  Your answers are displayed on the left.  The correct answers are displayed on the right. Correct answers are in green and incorrect answers are in red.  When you are ready, we will walk through these answers one by one with explanations.  Click Next to continue.");var h=Circsim.procedureController.get("key");var c=Circsim.columnController.get("current");var d=Circsim.procedureController.get("rows").length;var f=h.slice(c*d,(c+1)*d);var j=Circsim.columnController.get("content").get("cells");CoreCircsim.setCellsToCorrectValues(f,j);CoreCircsim.removeCorrectAnswers(Circsim.cellsController.get("allCells"));CoreCircsim.displayCorrectAnswers(j);Circsim.messagesController.set("content",g)}},next:function(){this.gotoState("DisplayProcedureSpecificComment")}}),DisplayProcedureSpecificComment:SC.State.design({enterState:function(){var a=Circsim.messagesController.get("content"),g,d,f,e,b;if(SC.compare(a,[])!==0&&SC.compare(a,null)!==0){a=a.shiftObject();g=a.get("comment");d=a.get("category");f=a.get("highlights");e=a.get("isCorrect");b=Circsim.columnController.get("content").get("cells");CoreCircsim.updateHighlighting(b,f);Circsim.messageController.set("content",g);Circsim.messageController.set("title",d);if(e){Circsim.messageController.set("color",Circsim.CORRECTCOLOR)}else{Circsim.messageController.set("color",Circsim.ERRORCOLOR)}var c=[];f.forEach(function(h){c.push(b.objectAt(h))});CoreCircsim.removeCorrectAnswers(Circsim.cellsController.get("allCells"));CoreCircsim.displayCorrectAnswers(c)}},exitState:function(){var a=Circsim.columnController.get("content").get("cells");CoreCircsim.updateHighlighting(a,null);a.forEach(function(b){b.set("isEnabled",NO)});Circsim.messageController.set("title","");Circsim.messageController.set("content","");Circsim.messageController.set("color",Circsim.NORMALCOLOR);CoreCircsim.removeCorrectAnswers(Circsim.cellsController.get("allCells"))},next:function(){var a=Circsim.messagesController.get("content");if(a&&a.length>0){this.gotoState("DisplayProcedureSpecificComment")}else{this.gotoState("CheckForRemainingColumns")}}})})}),CheckForRemainingColumns:SC.State.design({enterState:function(){var a=Circsim.procedureController.get("columns").length(),b=Circsim.columnController.get("current")+1;console.log("current: "+b+"; Total: "+a);if(b<a){this.remainingColumns()}else{this.procedureComplete()}},remainingColumns:function(){var a=Circsim.columnController.get("current");Circsim.columnController.set("current",a+1);this.gotoState("ColumnInput")},procedureComplete:function(){this.gotoState("ProcedureComplete")}})}),ProcedureComplete:SC.State.design({enterState:function(){Circsim.procedureController.get("content").set("isComplete",true);var a=Circsim.procedureController.get("content").get("title");Circsim.messageController.set("content","You have completed the "+a+" procedure!  Click on another procedure from the list to the left to continue Circsim.")},exitState:function(){Circsim.cellsController.get("allCells").forEach(function(a){a.set("value",null)});Circsim.cellsController.get("allCells").forEach(function(a){a.set("correctAnswer",null)});Circsim.columnController.set("current",0);Circsim.columnController.set("content","");Circsim.relationshipEvaluationsController.set("current",0)},next:function(){this.gotoState("Running")}}),selectProcedure:function(){this.gotoState("Procedure");Circsim.cellsController.notifyPropertyChange("allCells")},openHelp:function(){this.gotoState("Help")}}),Help:SC.State.design({enterState:function(){Circsim.contentController.set("contentDisplay","Circsim.contentViews.helpView");Circsim.toolbarDisplayController.set("helpDisplay","display:none;")},closeHelp:function(){this.gotoHistoryState("Running")}})});Circsim.CellView=SC.View.extend(SC.ContentDisplay,{contentDisplayProperties:"value isHighlighted isEnabled displayCorrectAnswer".w(),render:function(b,i){var k=this.get("content"),n=k.get("value"),d=k.get("column").get("header"),o=k.get("isEnabled"),p=k.get("isHighlighted"),a=k.get("correctAnswer"),g=k.get("displayCorrectAnswer");switch(n){case 0:n="0";break;case 1:n="<img src=/static/circsim/en/572a07a623c38674c62854ad2b984dfe3b2ccedc/source/resources/images/down.png />";break;case 2:n="<img src=/static/circsim/en/572a07a623c38674c62854ad2b984dfe3b2ccedc/source/resources/images/up.png />";break;default:n="";break}switch(a){case 0:a="0";break;case 1:a="<img src=/static/circsim/en/572a07a623c38674c62854ad2b984dfe3b2ccedc/source/resources/images/down.png />";break;case 2:a="<img src=/static/circsim/en/572a07a623c38674c62854ad2b984dfe3b2ccedc/source/resources/images/up.png />";break;default:a="";break}if(a){var j=o;var e=!o;var m=false;var q=false;var l=false;var h=false;if(g){if(a==n){if(p){l=true}else{m=true}}else{if(p){h=true}else{q=true}}}var c={enabled:j,disabled:e,correctomundo:m,wrongo:q,correctHighlight:l,incorrectHighlight:h};b.setClass(c);b.push('<span class="cell-value-student">'+n+"</span>");b.push('<span class="cell-value-correct">'+a+"</span>")}else{j=o;e=!o;c={enabled:j,disabled:e};b.setClass(c);b.push('<span class="cell-value">'+n+"</span>")}}});Circsim.contentViews=SC.Page.design({});Circsim.contentViews.helpView=SC.View.design({childViews:"helpContentView closeHelpButton".w(),closeHelpButton:SC.ButtonView.design({layout:{top:10,left:10,height:30,width:100},title:"Close Help",target:"Circsim.statechart",action:"closeHelp"}),helpContentView:SC.LabelView.design({layout:{top:55,bottom:0,right:0,left:0},value:"Help Screen goes here."})});Circsim.contentViews.introView=SC.View.design({childViews:"text".w(),text:SC.TemplateView.design({templateName:"circsim_intro",layerId:"circsim-introduction"})});Circsim.contentViews.procedureIntroView=SC.View.design({layout:{top:130,left:130,right:130,bottom:130},childViews:"startProcedureButton procedureIntroText".w(),procedureIntroText:SC.LabelView.design({layout:{right:0,left:0,top:0,bottom:30},valueBinding:"Circsim.procedureController.introduction"}),startProcedureButton:SC.ButtonView.design({layout:{bottom:0,left:0,height:24,width:124},title:"Begin Procedure",layerId:"begin-procedure-button",target:"Circsim.statechart",action:"beginProcedure"})});Circsim.contentViews.titleView=SC.View.design({childViews:"circsimLogoView startButton".w(),circsimLogoView:SC.TemplateView.design({templateName:"title",layerId:"title-information"}),startButton:SC.ButtonView.design({layout:{height:75,width:150,bottom:0,left:130},title:"Start Circsim",layerId:"start-circsim-button",target:"Circsim.statechart",action:"startCircsim"})});Circsim.GridHeaderView=SC.View.extend({render:function(a){var b=Circsim.procedureController.get("content").get("cols");a.push('<div id="grid-headers">');b.forEach(function(c){a.push("<div>"+c+"</div>")});a.push("</div>")}});Circsim.ProcedureMessagesView=SC.View.extend({render:function(a){var b=this.get("message");a.push("<p>",""+b+"","</p>")}});Circsim.PVView=SC.View.design({layout:{top:0,left:0,height:50,width:480},tagName:"div",layerId:"pv-view",backgroundColor:"#999",childViews:"pvLabel pvSelection".w(),pvLabel:SC.LabelView.design({layout:{top:15,width:150,height:20,left:20},value:"Primary Variable:",layerId:"pv-label"}),pvSelection:SC.SelectFieldView.design({layout:{top:15,width:340,height:20,right:15},valueBinding:"Circsim.pvSelectionController.content",objectsBinding:"Circsim.procedureController.rows",disableSort:true,emptyName:"Select the Primary Variable",layerId:"pv-select"})});Circsim.PVSummaryView=SC.View.design({layout:{top:0,left:0,height:50,width:480},tagName:"div",layerId:"pv-summary-view",backgroundColor:"#999",childViews:"pvLabel pvAnswer".w(),pvLabel:SC.LabelView.design({layout:{top:15,width:150,height:20,left:20},value:"Primary Variable:"}),pvAnswer:SC.LabelView.design({layout:{top:13,width:250,height:20,left:114},valueBinding:"Circsim.procedureController.currentPV",fontWeight:SC.BOLD_WEIGHT,layerId:"correct-pv-display"})});Circsim.RowView=SC.View.extend({render:function(a){var b=Circsim.procedureController.get("content").get("rows");a.push('<ul id="grid-rows">');b.forEach(function(c){a.push("<li>"+c+"</li>")});a.push("</ul>")}});Circsim.SelectView=SC.View.extend({tagName:"select",value:null,render:function(b){var a=Circsim.procedureController.get("rows");a.forEach(function(c){b.push('<option value="'+c+'">'+c+"</option>")})}});sc_require("views/procedure_messages");sc_require("views/pv");sc_require("views/row_view");sc_require("views/select_view");sc_require("lib/grid_patch");Circsim.contentViews.procedureView=SC.View.design({layerId:"procedure",layout:{left:0,top:0,right:0,bottom:0,minWidth:800},childViews:"procedureToolbar procedureContent".w(),procedureToolbar:SC.View.design({layout:{top:20,right:10,left:10,height:40},tagName:"div",layerId:"procedure-toolbar",childViews:"procedureTitle nextButton".w(),procedureTitle:SC.LabelView.design({layout:{top:0,right:10,left:10,height:20,centerY:0},tagName:"h3",layerId:"procedure-title",valueBinding:"Circsim.procedureController.title"}),nextButton:SC.ButtonView.design({layout:{right:10,width:31,height:15,centerY:-5},tagName:"div",layerId:"next-button",classNames:"btn",title:"Next",target:"Circsim.statechart",action:"next",render:function(a){var b=this.get("title");a.push(b)}})}),procedureContent:SC.View.design({layout:{top:60,right:10,left:10,bottom:0},tagName:"div",layerId:"procedure-content",childViews:"pvView predictionTableView messagesView".w(),pvView:SC.ContainerView.design({nowShowingBinding:"Circsim.pvViewDisplay"}),predictionTableView:SC.View.design({layout:{top:50,left:0,bottom:0,width:470},tagName:"div",layerId:"prediction-table-view",backgroundColor:"white",childViews:"gridView headerView rowTitleView".w(),headerView:Circsim.GridHeaderView.design({layout:{right:0,left:0,top:0,height:50}}),rowTitleView:Circsim.RowView.design({layout:{left:0,width:90,top:50,bottom:0}}),gridView:SC.GridView.design({layout:{right:4,top:50,left:68},insertionOrientation:SC.VERTICAL_ORIENTATION,columnWidth:120,rowHeight:50,contentBinding:"Circsim.cellsController.allCells",target:"Circsim.statechart",action:"clickedOnCell",actOnSelect:YES,exampleView:Circsim.CellView.design({classNames:"cell"})})}),messagesView:SC.View.design({layout:{top:0,left:480,bottom:0,right:0},childViews:"messageTitle messageBody".w(),tagName:"div",layerId:"messages-view",backgroundColor:"#FBFBFB",messageTitle:SC.LabelView.design({layout:{top:10,left:20,height:20,right:20},valueBinding:"Circsim.messageController.title",layerId:"messages-title",backgroundColorBinding:"Circsim.messageController.titleColor"}),messageBody:SC.LabelView.design({layout:{top:40,left:20,bottom:0,right:20},valueBinding:"Circsim.messageController.content",layerId:"messages-body",backgroundColorBinding:"Circsim.messageController.color"})})})});Circsim.sidebarViews=SC.Page.design({});Circsim.sidebarViews.runningView=SC.View.design({layout:{width:250},childViews:"procedureLabelView procedureListView".w(),procedureLabelView:SC.LabelView.design({layout:{top:0,bottom:0,left:0,right:0},backgroundColor:"#DDDDDD",layerId:"procedure-label",fontWeight:SC.BOLD_WEIGHT,value:"Procedures:"}),procedureListView:SC.ScrollView.design({hasHorizontalScroller:NO,layout:{top:32,bottom:0,left:0,right:0},backgroundColor:"#FBFBFB",contentView:SC.ListView.design({contentBinding:"Circsim.proceduresController.arrangedObjects",selectionBinding:"Circsim.proceduresController.selection",contentValueKey:"title",rowHeight:62,canDeleteContent:NO,actOnSelect:YES,target:"Circsim.statechart",action:"selectProcedure"})})});Circsim.sidebarViews.titleView=SC.View.design({layout:{width:250},backgroundColor:"#ebebeb"});Circsim.ToolbarView=SC.View.extend({render:function(b){var a=this.get("helpDisplay");var c=this.get("iconUrl");b.push('  <div id="logo-image"></div>','  <div id="circsim-title">',"    Circsim","  </div>",'  <div id="help-button" style="'+a+'">','    <div class="img"><img src="'+c+'" width="16" height="16" alt="Help"></div>','    <div class="left"></div>','    <div class="middle"></div>','    <div class="right"></div>',"    <label>Help</label> ","  </div>")},click:function(a){var b=a.target,c=b.id;while(!c){b=b.parentElement;c=b.id}if(c=="help-button"){Circsim.statechart.sendEvent("openHelp")}}});sc_require("views/toolbar");sc_require("views/procedure");Circsim.mainPage=SC.Page.design({mainPane:SC.MainPane.design({childViews:"toolbar middleView bottomView".w(),toolbar:Circsim.ToolbarView.design({iconUrl:"/static/circsim/en/572a07a623c38674c62854ad2b984dfe3b2ccedc/source/resources/images/help.png",helpDisplayBinding:"Circsim.toolbarDisplayController.helpDisplay",displayProperties:["helpDisplay"],tagName:"div",layerId:"top-toolbar",useStaticLayout:YES}),middleView:SC.SplitView.design({layout:{left:0,top:36,right:0,bottom:32},canCollapseViews:NO,defaultThickness:250,topLeftMaxThickness:250,dividerThickness:0,layoutDirection:SC.LAYOUT_HORIZONTAL,topLeftView:SC.ContainerView.extend({layout:{width:250},nowShowingBinding:"Circsim.sidebarView",layerId:"procedure-selection"}),dividerView:SC.View,bottomRightView:SC.ContainerView.design({layerId:"content",nowShowingBinding:"Circsim.contentController.contentDisplay"})}),bottomView:SC.TemplateView.design({templateName:"footer"})})});Circsim.main=function main(){Circsim.getPath("mainPage.mainPane").append();Circsim.proceduresController.set("content",CoreCircsim.store.find(CoreCircsim.Procedure));Circsim.statechart.initStatechart()};function main(){Circsim.main()};